2022-08-26 18:39:08.509671: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/statsmodels/compat/pandas.py:65: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import Int64Index as NumericIndex
Config:
{'all_joints': [[0],
                [1],
                [2],
                [3],
                [4],
                [5],
                [6],
                [7],
                [8],
                [9],
                [10],
                [11],
                [12],
                [13],
                [14],
                [15],
                [16],
                [17],
                [18],
                [19],
                [20],
                [21]],
 'all_joints_names': ['Nose',
                      'Eye',
                      'Nearknee',
                      'Nearfrontfetlock',
                      'Nearfrontfoot',
                      'Offknee',
                      'Offfrontfetlock',
                      'Offfrontfoot',
                      'Shoulder',
                      'Midshoulder',
                      'Elbow',
                      'Girth',
                      'Wither',
                      'Nearhindhock',
                      'Nearhindfetlock',
                      'Nearhindfoot',
                      'Hip',
                      'Stifle',
                      'Offhindhock',
                      'Offhindfetlock',
                      'Offhindfoot',
                      'Ischium'],
 'alpha_r': 0.02,
 'apply_prob': 0.5,
 'batch_size': 8,
 'contrast': {'clahe': True,
              'claheratio': 0.1,
              'histeq': True,
              'histeqratio': 0.1},
 'convolution': {'edge': False,
                 'emboss': {'alpha': [0.0, 1.0], 'strength': [0.5, 1.5]},
                 'embossratio': 0.1,
                 'sharpen': False,
                 'sharpenratio': 0.3},
 'crop_pad': 0,
 'cropratio': 0.4,
 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Horses_Byron16shuffle1.mat',
 'dataset_type': 'imgaug',
 'decay_steps': 30000,
 'deterministic': False,
 'display_iters': 1000,
 'fg_fraction': 0.25,
 'global_scale': 0.8,
 'init_weights': '/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt',
 'intermediate_supervision': False,
 'intermediate_supervision_layer': 12,
 'location_refinement': True,
 'locref_huber_loss': True,
 'locref_loss_weight': 0.05,
 'locref_stdev': 7.2801,
 'log_dir': 'log',
 'lr_init': 0.0005,
 'max_input_size': 1500,
 'mean_pixel': [123.68, 116.779, 103.939],
 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Documentation_data-Horses_16shuffle1.pickle',
 'min_input_size': 64,
 'mirror': False,
 'multi_stage': False,
 'multi_step': [[0.0001, 7500], ['5e-05', 12000], ['1e-05', 200000]],
 'net_type': 'resnet_50',
 'num_joints': 22,
 'optimizer': 'adam',
 'pairwise_huber_loss': False,
 'pairwise_predict': False,
 'partaffinityfield_predict': False,
 'pos_dist_thresh': 17,
 'project_path': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025',
 'regularize': False,
 'rotation': 25,
 'rotratio': 0.4,
 'save_iters': 50000,
 'scale_jitter_lo': 0.5,
 'scale_jitter_up': 1.25,
 'scoremap_dir': 'test',
 'shuffle': True,
 'snapshot_prefix': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025/dlc-models/iteration-0/HorsesMay8-trainset16shuffle1/train/snapshot',
 'stride': 8.0,
 'weigh_negatives': False,
 'weigh_only_present_joints': False,
 'weigh_part_predictions': False,
 'weight_decay': 0.0001}
2022-08-26 18:39:14.818587: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-08-26 18:39:16.172019: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-08-26 18:39:16.172080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20582 MB memory:  -> device: 0, name: NVIDIA RTX A5000, pci bus id: 0000:67:00.0, compute capability: 8.6
2022-08-26 18:39:16.583094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20582 MB memory:  -> device: 0, name: NVIDIA RTX A5000, pci bus id: 0000:67:00.0, compute capability: 8.6
2022-08-26 18:39:18.034762: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:354] MLIR V1 optimization pass is not enabled
2022-08-26 18:39:26.376421: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8302
/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1694: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
iteration: 1000 loss: 0.0342 lr: 0.0001
iteration: 2000 loss: 0.0181 lr: 0.0001
iteration: 3000 loss: 0.0143 lr: 0.0001
iteration: 4000 loss: 0.0124 lr: 0.0001
iteration: 5000 loss: 0.0111 lr: 0.0001
iteration: 6000 loss: 0.0102 lr: 0.0001
iteration: 7000 loss: 0.0096 lr: 0.0001
iteration: 8000 loss: 0.0088 lr: 5e-05
iteration: 9000 loss: 0.0080 lr: 5e-05
iteration: 10000 loss: 0.0076 lr: 5e-05
iteration: 11000 loss: 0.0075 lr: 5e-05
iteration: 12000 loss: 0.0073 lr: 5e-05
iteration: 13000 loss: 0.0066 lr: 1e-05
iteration: 14000 loss: 0.0064 lr: 1e-05
iteration: 15000 loss: 0.0063 lr: 1e-05
iteration: 16000 loss: 0.0064 lr: 1e-05
iteration: 17000 loss: 0.0063 lr: 1e-05
iteration: 18000 loss: 0.0063 lr: 1e-05
iteration: 19000 loss: 0.0061 lr: 1e-05
iteration: 20000 loss: 0.0061 lr: 1e-05
iteration: 21000 loss: 0.0060 lr: 1e-05
iteration: 22000 loss: 0.0060 lr: 1e-05
iteration: 23000 loss: 0.0060 lr: 1e-05
iteration: 24000 loss: 0.0061 lr: 1e-05
iteration: 25000 loss: 0.0059 lr: 1e-05
iteration: 26000 loss: 0.0059 lr: 1e-05
iteration: 27000 loss: 0.0058 lr: 1e-05
iteration: 28000 loss: 0.0058 lr: 1e-05
iteration: 29000 loss: 0.0058 lr: 1e-05
iteration: 30000 loss: 0.0058 lr: 1e-05
iteration: 31000 loss: 0.0057 lr: 1e-05
iteration: 32000 loss: 0.0057 lr: 1e-05
iteration: 33000 loss: 0.0056 lr: 1e-05
iteration: 34000 loss: 0.0056 lr: 1e-05
iteration: 35000 loss: 0.0055 lr: 1e-05
iteration: 36000 loss: 0.0055 lr: 1e-05
iteration: 37000 loss: 0.0054 lr: 1e-05
iteration: 38000 loss: 0.0054 lr: 1e-05
iteration: 39000 loss: 0.0053 lr: 1e-05
iteration: 40000 loss: 0.0053 lr: 1e-05
iteration: 41000 loss: 0.0052 lr: 1e-05
iteration: 42000 loss: 0.0052 lr: 1e-05
iteration: 43000 loss: 0.0051 lr: 1e-05
iteration: 44000 loss: 0.0051 lr: 1e-05
iteration: 45000 loss: 0.0050 lr: 1e-05
iteration: 46000 loss: 0.0051 lr: 1e-05
iteration: 47000 loss: 0.0050 lr: 1e-05
iteration: 48000 loss: 0.0049 lr: 1e-05
iteration: 49000 loss: 0.0050 lr: 1e-05
iteration: 50000 loss: 0.0049 lr: 1e-05
iteration: 51000 loss: 0.0049 lr: 1e-05
iteration: 52000 loss: 0.0049 lr: 1e-05
iteration: 53000 loss: 0.0049 lr: 1e-05
iteration: 54000 loss: 0.0048 lr: 1e-05
iteration: 55000 loss: 0.0047 lr: 1e-05
iteration: 56000 loss: 0.0047 lr: 1e-05
iteration: 57000 loss: 0.0047 lr: 1e-05
iteration: 58000 loss: 0.0048 lr: 1e-05
iteration: 59000 loss: 0.0047 lr: 1e-05
iteration: 60000 loss: 0.0047 lr: 1e-05
iteration: 61000 loss: 0.0047 lr: 1e-05
iteration: 62000 loss: 0.0046 lr: 1e-05
iteration: 63000 loss: 0.0046 lr: 1e-05
iteration: 64000 loss: 0.0046 lr: 1e-05
iteration: 65000 loss: 0.0046 lr: 1e-05
iteration: 66000 loss: 0.0046 lr: 1e-05
iteration: 67000 loss: 0.0046 lr: 1e-05
iteration: 68000 loss: 0.0045 lr: 1e-05
iteration: 69000 loss: 0.0045 lr: 1e-05
iteration: 70000 loss: 0.0045 lr: 1e-05
iteration: 71000 loss: 0.0046 lr: 1e-05
iteration: 72000 loss: 0.0045 lr: 1e-05
iteration: 73000 loss: 0.0045 lr: 1e-05
iteration: 74000 loss: 0.0045 lr: 1e-05
iteration: 75000 loss: 0.0044 lr: 1e-05
iteration: 76000 loss: 0.0044 lr: 1e-05
iteration: 77000 loss: 0.0045 lr: 1e-05
iteration: 78000 loss: 0.0045 lr: 1e-05
iteration: 79000 loss: 0.0044 lr: 1e-05
iteration: 80000 loss: 0.0044 lr: 1e-05
iteration: 81000 loss: 0.0044 lr: 1e-05
iteration: 82000 loss: 0.0044 lr: 1e-05
iteration: 83000 loss: 0.0043 lr: 1e-05
iteration: 84000 loss: 0.0043 lr: 1e-05
iteration: 85000 loss: 0.0044 lr: 1e-05
iteration: 86000 loss: 0.0044 lr: 1e-05
iteration: 87000 loss: 0.0043 lr: 1e-05
iteration: 88000 loss: 0.0043 lr: 1e-05
iteration: 89000 loss: 0.0043 lr: 1e-05
iteration: 90000 loss: 0.0043 lr: 1e-05
iteration: 91000 loss: 0.0043 lr: 1e-05
iteration: 92000 loss: 0.0043 lr: 1e-05
iteration: 93000 loss: 0.0043 lr: 1e-05
iteration: 94000 loss: 0.0043 lr: 1e-05
iteration: 95000 loss: 0.0043 lr: 1e-05
iteration: 96000 loss: 0.0043 lr: 1e-05
iteration: 97000 loss: 0.0043 lr: 1e-05
iteration: 98000 loss: 0.0042 lr: 1e-05
iteration: 99000 loss: 0.0042 lr: 1e-05
iteration: 100000 loss: 0.0042 lr: 1e-05
iteration: 101000 loss: 0.0042 lr: 1e-05
iteration: 102000 loss: 0.0042 lr: 1e-05
iteration: 103000 loss: 0.0041 lr: 1e-05
iteration: 104000 loss: 0.0042 lr: 1e-05
iteration: 105000 loss: 0.0042 lr: 1e-05
iteration: 106000 loss: 0.0042 lr: 1e-05
iteration: 107000 loss: 0.0042 lr: 1e-05
iteration: 108000 loss: 0.0041 lr: 1e-05
iteration: 109000 loss: 0.0041 lr: 1e-05
iteration: 110000 loss: 0.0041 lr: 1e-05
iteration: 111000 loss: 0.0041 lr: 1e-05
iteration: 112000 loss: 0.0040 lr: 1e-05
iteration: 113000 loss: 0.0041 lr: 1e-05
iteration: 114000 loss: 0.0041 lr: 1e-05
iteration: 115000 loss: 0.0041 lr: 1e-05
iteration: 116000 loss: 0.0041 lr: 1e-05
iteration: 117000 loss: 0.0041 lr: 1e-05
iteration: 118000 loss: 0.0041 lr: 1e-05
iteration: 119000 loss: 0.0041 lr: 1e-05
iteration: 120000 loss: 0.0040 lr: 1e-05
iteration: 121000 loss: 0.0040 lr: 1e-05
iteration: 122000 loss: 0.0041 lr: 1e-05
iteration: 123000 loss: 0.0041 lr: 1e-05
iteration: 124000 loss: 0.0040 lr: 1e-05
iteration: 125000 loss: 0.0041 lr: 1e-05
iteration: 126000 loss: 0.0040 lr: 1e-05
iteration: 127000 loss: 0.0040 lr: 1e-05
iteration: 128000 loss: 0.0040 lr: 1e-05
iteration: 129000 loss: 0.0040 lr: 1e-05
iteration: 130000 loss: 0.0040 lr: 1e-05
iteration: 131000 loss: 0.0040 lr: 1e-05
iteration: 132000 loss: 0.0041 lr: 1e-05
iteration: 133000 loss: 0.0039 lr: 1e-05
iteration: 134000 loss: 0.0040 lr: 1e-05
iteration: 135000 loss: 0.0040 lr: 1e-05
iteration: 136000 loss: 0.0040 lr: 1e-05
iteration: 137000 loss: 0.0040 lr: 1e-05
iteration: 138000 loss: 0.0040 lr: 1e-05
iteration: 139000 loss: 0.0039 lr: 1e-05
iteration: 140000 loss: 0.0039 lr: 1e-05
iteration: 141000 loss: 0.0039 lr: 1e-05
iteration: 142000 loss: 0.0039 lr: 1e-05
iteration: 143000 loss: 0.0039 lr: 1e-05
iteration: 144000 loss: 0.0040 lr: 1e-05
iteration: 145000 loss: 0.0039 lr: 1e-05
iteration: 146000 loss: 0.0039 lr: 1e-05
iteration: 147000 loss: 0.0039 lr: 1e-05
iteration: 148000 loss: 0.0039 lr: 1e-05
iteration: 149000 loss: 0.0039 lr: 1e-05
iteration: 150000 loss: 0.0038 lr: 1e-05
iteration: 151000 loss: 0.0039 lr: 1e-05
iteration: 152000 loss: 0.0038 lr: 1e-05
iteration: 153000 loss: 0.0039 lr: 1e-05
iteration: 154000 loss: 0.0039 lr: 1e-05
iteration: 155000 loss: 0.0039 lr: 1e-05
iteration: 156000 loss: 0.0039 lr: 1e-05
iteration: 157000 loss: 0.0038 lr: 1e-05
iteration: 158000 loss: 0.0038 lr: 1e-05
iteration: 159000 loss: 0.0039 lr: 1e-05
iteration: 160000 loss: 0.0038 lr: 1e-05
iteration: 161000 loss: 0.0038 lr: 1e-05
iteration: 162000 loss: 0.0038 lr: 1e-05
iteration: 163000 loss: 0.0039 lr: 1e-05
iteration: 164000 loss: 0.0039 lr: 1e-05
iteration: 165000 loss: 0.0038 lr: 1e-05
iteration: 166000 loss: 0.0038 lr: 1e-05
iteration: 167000 loss: 0.0038 lr: 1e-05
iteration: 168000 loss: 0.0038 lr: 1e-05
iteration: 169000 loss: 0.0038 lr: 1e-05
iteration: 170000 loss: 0.0038 lr: 1e-05
iteration: 171000 loss: 0.0037 lr: 1e-05
iteration: 172000 loss: 0.0038 lr: 1e-05
iteration: 173000 loss: 0.0038 lr: 1e-05
iteration: 174000 loss: 0.0038 lr: 1e-05
iteration: 175000 loss: 0.0038 lr: 1e-05
iteration: 176000 loss: 0.0037 lr: 1e-05
iteration: 177000 loss: 0.0037 lr: 1e-05
iteration: 178000 loss: 0.0037 lr: 1e-05
iteration: 179000 loss: 0.0037 lr: 1e-05
iteration: 180000 loss: 0.0038 lr: 1e-05
iteration: 181000 loss: 0.0038 lr: 1e-05
iteration: 182000 loss: 0.0038 lr: 1e-05
iteration: 183000 loss: 0.0037 lr: 1e-05
iteration: 184000 loss: 0.0038 lr: 1e-05
iteration: 185000 loss: 0.0037 lr: 1e-05
iteration: 186000 loss: 0.0038 lr: 1e-05
iteration: 187000 loss: 0.0037 lr: 1e-05
iteration: 188000 loss: 0.0038 lr: 1e-05
iteration: 189000 loss: 0.0037 lr: 1e-05
iteration: 190000 loss: 0.0037 lr: 1e-05
iteration: 191000 loss: 0.0038 lr: 1e-05
iteration: 192000 loss: 0.0037 lr: 1e-05
iteration: 193000 loss: 0.0037 lr: 1e-05
iteration: 194000 loss: 0.0037 lr: 1e-05
iteration: 195000 loss: 0.0037 lr: 1e-05
iteration: 196000 loss: 0.0037 lr: 1e-05
iteration: 197000 loss: 0.0037 lr: 1e-05
iteration: 198000 loss: 0.0037 lr: 1e-05
iteration: 199000 loss: 0.0037 lr: 1e-05
iteration: 200000 loss: 0.0036 lr: 1e-05
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 83, in load_and_enqueue
    sess.run(enqueue_op, feed_dict=food)
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 967, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1115, in _run
    raise RuntimeError('Attempted to use a closed Session.')
RuntimeError: Attempted to use a closed Session.
Config:
{'all_joints': [[0],
                [1],
                [2],
                [3],
                [4],
                [5],
                [6],
                [7],
                [8],
                [9],
                [10],
                [11],
                [12],
                [13],
                [14],
                [15],
                [16],
                [17],
                [18],
                [19],
                [20],
                [21]],
 'all_joints_names': ['Nose',
                      'Eye',
                      'Nearknee',
                      'Nearfrontfetlock',
                      'Nearfrontfoot',
                      'Offknee',
                      'Offfrontfetlock',
                      'Offfrontfoot',
                      'Shoulder',
                      'Midshoulder',
                      'Elbow',
                      'Girth',
                      'Wither',
                      'Nearhindhock',
                      'Nearhindfetlock',
                      'Nearhindfoot',
                      'Hip',
                      'Stifle',
                      'Offhindhock',
                      'Offhindfetlock',
                      'Offhindfoot',
                      'Ischium'],
 'alpha_r': 0.02,
 'apply_prob': 0.5,
 'batch_size': 8,
 'contrast': {'clahe': True,
              'claheratio': 0.1,
              'histeq': True,
              'histeqratio': 0.1},
 'convolution': {'edge': False,
                 'emboss': {'alpha': [0.0, 1.0], 'strength': [0.5, 1.5]},
                 'embossratio': 0.1,
                 'sharpen': False,
                 'sharpenratio': 0.3},
 'crop_pad': 0,
 'cropratio': 0.4,
 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Horses_Byron17shuffle2.mat',
 'dataset_type': 'imgaug',
 'decay_steps': 30000,
 'deterministic': False,
 'display_iters': 1000,
 'fg_fraction': 0.25,
 'global_scale': 0.8,
 'init_weights': '/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt',
 'intermediate_supervision': False,
 'intermediate_supervision_layer': 12,
 'location_refinement': True,
 'locref_huber_loss': True,
 'locref_loss_weight': 0.05,
 'locref_stdev': 7.2801,
 'log_dir': 'log',
 'lr_init': 0.0005,
 'max_input_size': 1500,
 'mean_pixel': [123.68, 116.779, 103.939],
 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Documentation_data-Horses_17shuffle2.pickle',
 'min_input_size': 64,
 'mirror': False,
 'multi_stage': False,
 'multi_step': [[0.0001, 7500], ['5e-05', 12000], ['1e-05', 200000]],
 'net_type': 'resnet_50',
 'num_joints': 22,
 'optimizer': 'adam',
 'pairwise_huber_loss': False,
 'pairwise_predict': False,
 'partaffinityfield_predict': False,
 'pos_dist_thresh': 17,
 'project_path': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025',
 'regularize': False,
 'rotation': 25,
 'rotratio': 0.4,
 'save_iters': 50000,
 'scale_jitter_lo': 0.5,
 'scale_jitter_up': 1.25,
 'scoremap_dir': 'test',
 'shuffle': True,
 'snapshot_prefix': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025/dlc-models/iteration-0/HorsesMay8-trainset17shuffle2/train/snapshot',
 'stride': 8.0,
 'weigh_negatives': False,
 'weigh_only_present_joints': False,
 'weigh_part_predictions': False,
 'weight_decay': 0.0001}
2022-08-27 02:07:48.987519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20582 MB memory:  -> device: 0, name: NVIDIA RTX A5000, pci bus id: 0000:67:00.0, compute capability: 8.6
iteration: 1000 loss: 0.0341 lr: 0.0001
iteration: 2000 loss: 0.0195 lr: 0.0001
iteration: 3000 loss: 0.0158 lr: 0.0001
iteration: 4000 loss: 0.0128 lr: 0.0001
iteration: 5000 loss: 0.0113 lr: 0.0001
iteration: 6000 loss: 0.0108 lr: 0.0001
iteration: 7000 loss: 0.0099 lr: 0.0001
iteration: 8000 loss: 0.0092 lr: 5e-05
iteration: 9000 loss: 0.0082 lr: 5e-05
iteration: 10000 loss: 0.0082 lr: 5e-05
iteration: 11000 loss: 0.0079 lr: 5e-05
iteration: 12000 loss: 0.0077 lr: 5e-05
iteration: 13000 loss: 0.0068 lr: 1e-05
iteration: 14000 loss: 0.0068 lr: 1e-05
iteration: 15000 loss: 0.0067 lr: 1e-05
iteration: 16000 loss: 0.0066 lr: 1e-05
iteration: 17000 loss: 0.0065 lr: 1e-05
iteration: 18000 loss: 0.0064 lr: 1e-05
iteration: 19000 loss: 0.0064 lr: 1e-05
iteration: 20000 loss: 0.0063 lr: 1e-05
iteration: 21000 loss: 0.0063 lr: 1e-05
iteration: 22000 loss: 0.0061 lr: 1e-05
iteration: 23000 loss: 0.0062 lr: 1e-05
iteration: 24000 loss: 0.0062 lr: 1e-05
iteration: 25000 loss: 0.0061 lr: 1e-05
iteration: 26000 loss: 0.0060 lr: 1e-05
iteration: 27000 loss: 0.0059 lr: 1e-05
iteration: 28000 loss: 0.0058 lr: 1e-05
iteration: 29000 loss: 0.0058 lr: 1e-05
iteration: 30000 loss: 0.0057 lr: 1e-05
iteration: 31000 loss: 0.0057 lr: 1e-05
iteration: 32000 loss: 0.0057 lr: 1e-05
iteration: 33000 loss: 0.0057 lr: 1e-05
iteration: 34000 loss: 0.0055 lr: 1e-05
iteration: 35000 loss: 0.0054 lr: 1e-05
iteration: 36000 loss: 0.0055 lr: 1e-05
iteration: 37000 loss: 0.0054 lr: 1e-05
iteration: 38000 loss: 0.0054 lr: 1e-05
iteration: 39000 loss: 0.0053 lr: 1e-05
iteration: 40000 loss: 0.0053 lr: 1e-05
iteration: 41000 loss: 0.0053 lr: 1e-05
iteration: 42000 loss: 0.0053 lr: 1e-05
iteration: 43000 loss: 0.0051 lr: 1e-05
iteration: 44000 loss: 0.0052 lr: 1e-05
iteration: 45000 loss: 0.0051 lr: 1e-05
iteration: 46000 loss: 0.0052 lr: 1e-05
iteration: 47000 loss: 0.0051 lr: 1e-05
iteration: 48000 loss: 0.0051 lr: 1e-05
iteration: 49000 loss: 0.0050 lr: 1e-05
iteration: 50000 loss: 0.0050 lr: 1e-05
iteration: 51000 loss: 0.0051 lr: 1e-05
iteration: 52000 loss: 0.0051 lr: 1e-05
iteration: 53000 loss: 0.0050 lr: 1e-05
iteration: 54000 loss: 0.0049 lr: 1e-05
iteration: 55000 loss: 0.0049 lr: 1e-05
iteration: 56000 loss: 0.0049 lr: 1e-05
iteration: 57000 loss: 0.0050 lr: 1e-05
iteration: 58000 loss: 0.0049 lr: 1e-05
iteration: 59000 loss: 0.0049 lr: 1e-05
iteration: 60000 loss: 0.0049 lr: 1e-05
iteration: 61000 loss: 0.0048 lr: 1e-05
iteration: 62000 loss: 0.0048 lr: 1e-05
iteration: 63000 loss: 0.0048 lr: 1e-05
iteration: 64000 loss: 0.0048 lr: 1e-05
iteration: 65000 loss: 0.0047 lr: 1e-05
iteration: 66000 loss: 0.0048 lr: 1e-05
iteration: 67000 loss: 0.0048 lr: 1e-05
iteration: 68000 loss: 0.0048 lr: 1e-05
iteration: 69000 loss: 0.0048 lr: 1e-05
iteration: 70000 loss: 0.0046 lr: 1e-05
iteration: 71000 loss: 0.0048 lr: 1e-05
iteration: 72000 loss: 0.0046 lr: 1e-05
iteration: 73000 loss: 0.0047 lr: 1e-05
iteration: 74000 loss: 0.0047 lr: 1e-05
iteration: 75000 loss: 0.0046 lr: 1e-05
iteration: 76000 loss: 0.0046 lr: 1e-05
iteration: 77000 loss: 0.0046 lr: 1e-05
iteration: 78000 loss: 0.0046 lr: 1e-05
iteration: 79000 loss: 0.0046 lr: 1e-05
iteration: 80000 loss: 0.0045 lr: 1e-05
iteration: 81000 loss: 0.0045 lr: 1e-05
iteration: 82000 loss: 0.0046 lr: 1e-05
iteration: 83000 loss: 0.0046 lr: 1e-05
iteration: 84000 loss: 0.0045 lr: 1e-05
iteration: 85000 loss: 0.0045 lr: 1e-05
iteration: 86000 loss: 0.0045 lr: 1e-05
iteration: 87000 loss: 0.0045 lr: 1e-05
iteration: 88000 loss: 0.0044 lr: 1e-05
iteration: 89000 loss: 0.0045 lr: 1e-05
iteration: 90000 loss: 0.0045 lr: 1e-05
iteration: 91000 loss: 0.0044 lr: 1e-05
iteration: 92000 loss: 0.0045 lr: 1e-05
iteration: 93000 loss: 0.0044 lr: 1e-05
iteration: 94000 loss: 0.0045 lr: 1e-05
iteration: 95000 loss: 0.0044 lr: 1e-05
iteration: 96000 loss: 0.0044 lr: 1e-05
iteration: 97000 loss: 0.0044 lr: 1e-05
iteration: 98000 loss: 0.0044 lr: 1e-05
iteration: 99000 loss: 0.0044 lr: 1e-05
iteration: 100000 loss: 0.0043 lr: 1e-05
iteration: 101000 loss: 0.0044 lr: 1e-05
iteration: 102000 loss: 0.0043 lr: 1e-05
iteration: 103000 loss: 0.0044 lr: 1e-05
iteration: 104000 loss: 0.0043 lr: 1e-05
iteration: 105000 loss: 0.0044 lr: 1e-05
iteration: 106000 loss: 0.0043 lr: 1e-05
iteration: 107000 loss: 0.0043 lr: 1e-05
iteration: 108000 loss: 0.0043 lr: 1e-05
iteration: 109000 loss: 0.0043 lr: 1e-05
iteration: 110000 loss: 0.0044 lr: 1e-05
iteration: 111000 loss: 0.0043 lr: 1e-05
iteration: 112000 loss: 0.0043 lr: 1e-05
iteration: 113000 loss: 0.0043 lr: 1e-05
iteration: 114000 loss: 0.0042 lr: 1e-05
iteration: 115000 loss: 0.0042 lr: 1e-05
iteration: 116000 loss: 0.0043 lr: 1e-05
iteration: 117000 loss: 0.0042 lr: 1e-05
iteration: 118000 loss: 0.0043 lr: 1e-05
iteration: 119000 loss: 0.0043 lr: 1e-05
iteration: 120000 loss: 0.0042 lr: 1e-05
iteration: 121000 loss: 0.0042 lr: 1e-05
iteration: 122000 loss: 0.0041 lr: 1e-05
iteration: 123000 loss: 0.0042 lr: 1e-05
iteration: 124000 loss: 0.0042 lr: 1e-05
iteration: 125000 loss: 0.0042 lr: 1e-05
iteration: 126000 loss: 0.0042 lr: 1e-05
iteration: 127000 loss: 0.0041 lr: 1e-05
iteration: 128000 loss: 0.0042 lr: 1e-05
iteration: 129000 loss: 0.0042 lr: 1e-05
iteration: 130000 loss: 0.0041 lr: 1e-05
iteration: 131000 loss: 0.0041 lr: 1e-05
iteration: 132000 loss: 0.0041 lr: 1e-05
iteration: 133000 loss: 0.0042 lr: 1e-05
iteration: 134000 loss: 0.0041 lr: 1e-05
iteration: 135000 loss: 0.0041 lr: 1e-05
iteration: 136000 loss: 0.0041 lr: 1e-05
iteration: 137000 loss: 0.0041 lr: 1e-05
iteration: 138000 loss: 0.0042 lr: 1e-05
iteration: 139000 loss: 0.0041 lr: 1e-05
iteration: 140000 loss: 0.0041 lr: 1e-05
iteration: 141000 loss: 0.0041 lr: 1e-05
iteration: 142000 loss: 0.0041 lr: 1e-05
iteration: 143000 loss: 0.0041 lr: 1e-05
iteration: 144000 loss: 0.0041 lr: 1e-05
iteration: 145000 loss: 0.0041 lr: 1e-05
iteration: 146000 loss: 0.0040 lr: 1e-05
iteration: 147000 loss: 0.0041 lr: 1e-05
iteration: 148000 loss: 0.0040 lr: 1e-05
iteration: 149000 loss: 0.0041 lr: 1e-05
iteration: 150000 loss: 0.0040 lr: 1e-05
iteration: 151000 loss: 0.0040 lr: 1e-05
iteration: 152000 loss: 0.0040 lr: 1e-05
iteration: 153000 loss: 0.0041 lr: 1e-05
iteration: 154000 loss: 0.0041 lr: 1e-05
iteration: 155000 loss: 0.0040 lr: 1e-05
iteration: 156000 loss: 0.0040 lr: 1e-05
iteration: 157000 loss: 0.0039 lr: 1e-05
iteration: 158000 loss: 0.0040 lr: 1e-05
iteration: 159000 loss: 0.0039 lr: 1e-05
iteration: 160000 loss: 0.0040 lr: 1e-05
iteration: 161000 loss: 0.0039 lr: 1e-05
iteration: 162000 loss: 0.0040 lr: 1e-05
iteration: 163000 loss: 0.0039 lr: 1e-05
iteration: 164000 loss: 0.0039 lr: 1e-05
iteration: 165000 loss: 0.0039 lr: 1e-05
iteration: 166000 loss: 0.0039 lr: 1e-05
iteration: 167000 loss: 0.0040 lr: 1e-05
iteration: 168000 loss: 0.0039 lr: 1e-05
iteration: 169000 loss: 0.0039 lr: 1e-05
iteration: 170000 loss: 0.0040 lr: 1e-05
iteration: 171000 loss: 0.0039 lr: 1e-05
iteration: 172000 loss: 0.0039 lr: 1e-05
iteration: 173000 loss: 0.0039 lr: 1e-05
iteration: 174000 loss: 0.0039 lr: 1e-05
iteration: 175000 loss: 0.0039 lr: 1e-05
iteration: 176000 loss: 0.0039 lr: 1e-05
iteration: 177000 loss: 0.0039 lr: 1e-05
iteration: 178000 loss: 0.0039 lr: 1e-05
iteration: 179000 loss: 0.0039 lr: 1e-05
iteration: 180000 loss: 0.0039 lr: 1e-05
iteration: 181000 loss: 0.0039 lr: 1e-05
iteration: 182000 loss: 0.0039 lr: 1e-05
iteration: 183000 loss: 0.0039 lr: 1e-05
iteration: 184000 loss: 0.0039 lr: 1e-05
iteration: 185000 loss: 0.0039 lr: 1e-05
iteration: 186000 loss: 0.0039 lr: 1e-05
iteration: 187000 loss: 0.0039 lr: 1e-05
iteration: 188000 loss: 0.0039 lr: 1e-05
iteration: 189000 loss: 0.0039 lr: 1e-05
iteration: 190000 loss: 0.0038 lr: 1e-05
iteration: 191000 loss: 0.0039 lr: 1e-05
iteration: 192000 loss: 0.0039 lr: 1e-05
iteration: 193000 loss: 0.0038 lr: 1e-05
iteration: 194000 loss: 0.0038 lr: 1e-05
iteration: 195000 loss: 0.0038 lr: 1e-05
iteration: 196000 loss: 0.0038 lr: 1e-05
iteration: 197000 loss: 0.0039 lr: 1e-05
iteration: 198000 loss: 0.0038 lr: 1e-05
iteration: 199000 loss: 0.0038 lr: 1e-05
iteration: 200000 loss: 0.0038 lr: 1e-05
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 83, in load_and_enqueue
    sess.run(enqueue_op, feed_dict=food)
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 967, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1115, in _run
    raise RuntimeError('Attempted to use a closed Session.')
RuntimeError: Attempted to use a closed Session.
Config:
{'all_joints': [[0],
                [1],
                [2],
                [3],
                [4],
                [5],
                [6],
                [7],
                [8],
                [9],
                [10],
                [11],
                [12],
                [13],
                [14],
                [15],
                [16],
                [17],
                [18],
                [19],
                [20],
                [21]],
 'all_joints_names': ['Nose',
                      'Eye',
                      'Nearknee',
                      'Nearfrontfetlock',
                      'Nearfrontfoot',
                      'Offknee',
                      'Offfrontfetlock',
                      'Offfrontfoot',
                      'Shoulder',
                      'Midshoulder',
                      'Elbow',
                      'Girth',
                      'Wither',
                      'Nearhindhock',
                      'Nearhindfetlock',
                      'Nearhindfoot',
                      'Hip',
                      'Stifle',
                      'Offhindhock',
                      'Offhindfetlock',
                      'Offhindfoot',
                      'Ischium'],
 'alpha_r': 0.02,
 'apply_prob': 0.5,
 'batch_size': 8,
 'contrast': {'clahe': True,
              'claheratio': 0.1,
              'histeq': True,
              'histeqratio': 0.1},
 'convolution': {'edge': False,
                 'emboss': {'alpha': [0.0, 1.0], 'strength': [0.5, 1.5]},
                 'embossratio': 0.1,
                 'sharpen': False,
                 'sharpenratio': 0.3},
 'crop_pad': 0,
 'cropratio': 0.4,
 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Horses_Byron15shuffle3.mat',
 'dataset_type': 'imgaug',
 'decay_steps': 30000,
 'deterministic': False,
 'display_iters': 1000,
 'fg_fraction': 0.25,
 'global_scale': 0.8,
 'init_weights': '/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt',
 'intermediate_supervision': False,
 'intermediate_supervision_layer': 12,
 'location_refinement': True,
 'locref_huber_loss': True,
 'locref_loss_weight': 0.05,
 'locref_stdev': 7.2801,
 'log_dir': 'log',
 'lr_init': 0.0005,
 'max_input_size': 1500,
 'mean_pixel': [123.68, 116.779, 103.939],
 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Documentation_data-Horses_15shuffle3.pickle',
 'min_input_size': 64,
 'mirror': False,
 'multi_stage': False,
 'multi_step': [[0.0001, 7500], ['5e-05', 12000], ['1e-05', 200000]],
 'net_type': 'resnet_50',
 'num_joints': 22,
 'optimizer': 'adam',
 'pairwise_huber_loss': False,
 'pairwise_predict': False,
 'partaffinityfield_predict': False,
 'pos_dist_thresh': 17,
 'project_path': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025',
 'regularize': False,
 'rotation': 25,
 'rotratio': 0.4,
 'save_iters': 50000,
 'scale_jitter_lo': 0.5,
 'scale_jitter_up': 1.25,
 'scoremap_dir': 'test',
 'shuffle': True,
 'snapshot_prefix': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025/dlc-models/iteration-0/HorsesMay8-trainset15shuffle3/train/snapshot',
 'stride': 8.0,
 'weigh_negatives': False,
 'weigh_only_present_joints': False,
 'weigh_part_predictions': False,
 'weight_decay': 0.0001}
2022-08-27 09:48:39.956045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20582 MB memory:  -> device: 0, name: NVIDIA RTX A5000, pci bus id: 0000:67:00.0, compute capability: 8.6
Loading DLC 2.2.1.1...
DLC loaded in light mode; you cannot use any GUI (labeling, relabeling and standalone GUI)
Selecting single-animal trainer
Batch Size is 8
Loading ImageNet-pretrained resnet_50
Max_iters overwritten as 200000
Display_iters overwritten as 1000
Save_iters overwritten as 50000
Training parameter:
{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025/dlc-models/iteration-0/HorsesMay8-trainset16shuffle1/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'adam', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 8, 'dataset_type': 'imgaug', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20], [21]], 'all_joints_names': ['Nose', 'Eye', 'Nearknee', 'Nearfrontfetlock', 'Nearfrontfoot', 'Offknee', 'Offfrontfetlock', 'Offfrontfoot', 'Shoulder', 'Midshoulder', 'Elbow', 'Girth', 'Wither', 'Nearhindhock', 'Nearhindfetlock', 'Nearhindfoot', 'Hip', 'Stifle', 'Offhindhock', 'Offhindfetlock', 'Offhindfoot', 'Ischium'], 'alpha_r': 0.02, 'apply_prob': 0.5, 'contrast': {'clahe': True, 'claheratio': 0.1, 'histeq': True, 'histeqratio': 0.1, 'gamma': False, 'sigmoid': False, 'log': False, 'linear': False}, 'convolution': {'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'strength': [0.5, 1.5]}, 'embossratio': 0.1, 'sharpen': False, 'sharpenratio': 0.3}, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Horses_Byron16shuffle1.mat', 'decay_steps': 30000, 'display_iters': 1000, 'init_weights': '/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Documentation_data-Horses_16shuffle1.pickle', 'min_input_size': 64, 'multi_stage': False, 'multi_step': [[0.0001, 7500], ['5e-05', 12000], ['1e-05', 200000]], 'net_type': 'resnet_50', 'num_joints': 22, 'pos_dist_thresh': 17, 'project_path': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}, 'snow': False, 'clouds': False, 'fog': False, 'snow_flakes': False, 'rain': False}
Starting training....
The network is now trained and ready to evaluate. Use the function 'evaluate_network' to evaluate the network.
Selecting single-animal trainer
Batch Size is 8
Loading ImageNet-pretrained resnet_50
Max_iters overwritten as 200000
Display_iters overwritten as 1000
Save_iters overwritten as 50000
Training parameter:
{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025/dlc-models/iteration-0/HorsesMay8-trainset17shuffle2/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'adam', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 8, 'dataset_type': 'imgaug', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20], [21]], 'all_joints_names': ['Nose', 'Eye', 'Nearknee', 'Nearfrontfetlock', 'Nearfrontfoot', 'Offknee', 'Offfrontfetlock', 'Offfrontfoot', 'Shoulder', 'Midshoulder', 'Elbow', 'Girth', 'Wither', 'Nearhindhock', 'Nearhindfetlock', 'Nearhindfoot', 'Hip', 'Stifle', 'Offhindhock', 'Offhindfetlock', 'Offhindfoot', 'Ischium'], 'alpha_r': 0.02, 'apply_prob': 0.5, 'contrast': {'clahe': True, 'claheratio': 0.1, 'histeq': True, 'histeqratio': 0.1, 'gamma': False, 'sigmoid': False, 'log': False, 'linear': False}, 'convolution': {'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'strength': [0.5, 1.5]}, 'embossratio': 0.1, 'sharpen': False, 'sharpenratio': 0.3}, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Horses_Byron17shuffle2.mat', 'decay_steps': 30000, 'display_iters': 1000, 'init_weights': '/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Documentation_data-Horses_17shuffle2.pickle', 'min_input_size': 64, 'multi_stage': False, 'multi_step': [[0.0001, 7500], ['5e-05', 12000], ['1e-05', 200000]], 'net_type': 'resnet_50', 'num_joints': 22, 'pos_dist_thresh': 17, 'project_path': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}, 'snow': False, 'clouds': False, 'fog': False, 'snow_flakes': False, 'rain': False}
Starting training....
The network is now trained and ready to evaluate. Use the function 'evaluate_network' to evaluate the network.
Selecting single-animal trainer
Batch Size is 8
Loading ImageNet-pretrained resnet_50
Max_iters overwritten as 200000
Display_iters overwritten as 1000
Save_iters overwritten as 50000
Training parameter:
iteration: 1000 loss: 0.0385 lr: 0.0001
iteration: 2000 loss: 0.0199 lr: 0.0001
iteration: 3000 loss: 0.0159 lr: 0.0001
iteration: 4000 loss: 0.0133 lr: 0.0001
iteration: 5000 loss: 0.0122 lr: 0.0001
iteration: 6000 loss: 0.0110 lr: 0.0001
iteration: 7000 loss: 0.0104 lr: 0.0001
iteration: 8000 loss: 0.0094 lr: 5e-05
iteration: 9000 loss: 0.0081 lr: 5e-05
iteration: 10000 loss: 0.0080 lr: 5e-05
iteration: 11000 loss: 0.0077 lr: 5e-05
iteration: 12000 loss: 0.0075 lr: 5e-05
iteration: 13000 loss: 0.0068 lr: 1e-05
iteration: 14000 loss: 0.0066 lr: 1e-05
iteration: 15000 loss: 0.0065 lr: 1e-05
iteration: 16000 loss: 0.0064 lr: 1e-05
iteration: 17000 loss: 0.0063 lr: 1e-05
iteration: 18000 loss: 0.0063 lr: 1e-05
iteration: 19000 loss: 0.0062 lr: 1e-05
iteration: 20000 loss: 0.0062 lr: 1e-05
iteration: 21000 loss: 0.0061 lr: 1e-05
iteration: 22000 loss: 0.0061 lr: 1e-05
iteration: 23000 loss: 0.0060 lr: 1e-05
iteration: 24000 loss: 0.0060 lr: 1e-05
iteration: 25000 loss: 0.0059 lr: 1e-05
iteration: 26000 loss: 0.0059 lr: 1e-05
iteration: 27000 loss: 0.0058 lr: 1e-05
iteration: 28000 loss: 0.0059 lr: 1e-05
iteration: 29000 loss: 0.0058 lr: 1e-05
iteration: 30000 loss: 0.0059 lr: 1e-05
iteration: 31000 loss: 0.0058 lr: 1e-05
iteration: 32000 loss: 0.0058 lr: 1e-05
iteration: 33000 loss: 0.0057 lr: 1e-05
iteration: 34000 loss: 0.0057 lr: 1e-05
iteration: 35000 loss: 0.0057 lr: 1e-05
iteration: 36000 loss: 0.0056 lr: 1e-05
iteration: 37000 loss: 0.0055 lr: 1e-05
iteration: 38000 loss: 0.0056 lr: 1e-05
iteration: 39000 loss: 0.0055 lr: 1e-05
iteration: 40000 loss: 0.0054 lr: 1e-05
iteration: 41000 loss: 0.0054 lr: 1e-05
iteration: 42000 loss: 0.0054 lr: 1e-05
iteration: 43000 loss: 0.0055 lr: 1e-05
iteration: 44000 loss: 0.0054 lr: 1e-05
iteration: 45000 loss: 0.0053 lr: 1e-05
iteration: 46000 loss: 0.0053 lr: 1e-05
iteration: 47000 loss: 0.0052 lr: 1e-05
iteration: 48000 loss: 0.0052 lr: 1e-05
iteration: 49000 loss: 0.0052 lr: 1e-05
iteration: 50000 loss: 0.0051 lr: 1e-05
iteration: 51000 loss: 0.0051 lr: 1e-05
iteration: 52000 loss: 0.0050 lr: 1e-05
iteration: 53000 loss: 0.0050 lr: 1e-05
iteration: 54000 loss: 0.0050 lr: 1e-05
iteration: 55000 loss: 0.0050 lr: 1e-05
iteration: 56000 loss: 0.0050 lr: 1e-05
iteration: 57000 loss: 0.0049 lr: 1e-05
iteration: 58000 loss: 0.0049 lr: 1e-05
iteration: 59000 loss: 0.0048 lr: 1e-05
iteration: 60000 loss: 0.0048 lr: 1e-05
iteration: 61000 loss: 0.0049 lr: 1e-05
iteration: 62000 loss: 0.0048 lr: 1e-05
iteration: 63000 loss: 0.0048 lr: 1e-05
iteration: 64000 loss: 0.0048 lr: 1e-05
iteration: 65000 loss: 0.0048 lr: 1e-05
iteration: 66000 loss: 0.0047 lr: 1e-05
iteration: 67000 loss: 0.0047 lr: 1e-05
iteration: 68000 loss: 0.0047 lr: 1e-05
iteration: 69000 loss: 0.0046 lr: 1e-05
iteration: 70000 loss: 0.0046 lr: 1e-05
iteration: 71000 loss: 0.0047 lr: 1e-05
iteration: 72000 loss: 0.0047 lr: 1e-05
iteration: 73000 loss: 0.0046 lr: 1e-05
iteration: 74000 loss: 0.0046 lr: 1e-05
iteration: 75000 loss: 0.0045 lr: 1e-05
iteration: 76000 loss: 0.0046 lr: 1e-05
iteration: 77000 loss: 0.0046 lr: 1e-05
iteration: 78000 loss: 0.0046 lr: 1e-05
iteration: 79000 loss: 0.0046 lr: 1e-05
iteration: 80000 loss: 0.0044 lr: 1e-05
iteration: 81000 loss: 0.0045 lr: 1e-05
iteration: 82000 loss: 0.0045 lr: 1e-05
iteration: 83000 loss: 0.0045 lr: 1e-05
iteration: 84000 loss: 0.0044 lr: 1e-05
iteration: 85000 loss: 0.0045 lr: 1e-05
iteration: 86000 loss: 0.0044 lr: 1e-05
iteration: 87000 loss: 0.0044 lr: 1e-05
iteration: 88000 loss: 0.0044 lr: 1e-05
iteration: 89000 loss: 0.0044 lr: 1e-05
iteration: 90000 loss: 0.0044 lr: 1e-05
iteration: 91000 loss: 0.0044 lr: 1e-05
iteration: 92000 loss: 0.0043 lr: 1e-05
iteration: 93000 loss: 0.0043 lr: 1e-05
iteration: 94000 loss: 0.0043 lr: 1e-05
iteration: 95000 loss: 0.0043 lr: 1e-05
iteration: 96000 loss: 0.0043 lr: 1e-05
iteration: 97000 loss: 0.0042 lr: 1e-05
iteration: 98000 loss: 0.0043 lr: 1e-05
iteration: 99000 loss: 0.0043 lr: 1e-05
iteration: 100000 loss: 0.0043 lr: 1e-05
iteration: 101000 loss: 0.0043 lr: 1e-05
iteration: 102000 loss: 0.0042 lr: 1e-05
iteration: 103000 loss: 0.0041 lr: 1e-05
iteration: 104000 loss: 0.0042 lr: 1e-05
iteration: 105000 loss: 0.0042 lr: 1e-05
iteration: 106000 loss: 0.0041 lr: 1e-05
iteration: 107000 loss: 0.0042 lr: 1e-05
iteration: 108000 loss: 0.0043 lr: 1e-05
iteration: 109000 loss: 0.0042 lr: 1e-05
iteration: 110000 loss: 0.0042 lr: 1e-05
iteration: 111000 loss: 0.0041 lr: 1e-05
iteration: 112000 loss: 0.0042 lr: 1e-05
iteration: 113000 loss: 0.0041 lr: 1e-05
iteration: 114000 loss: 0.0041 lr: 1e-05
iteration: 115000 loss: 0.0042 lr: 1e-05
iteration: 116000 loss: 0.0041 lr: 1e-05
iteration: 117000 loss: 0.0041 lr: 1e-05
iteration: 118000 loss: 0.0041 lr: 1e-05
iteration: 119000 loss: 0.0041 lr: 1e-05
iteration: 120000 loss: 0.0041 lr: 1e-05
iteration: 121000 loss: 0.0041 lr: 1e-05
iteration: 122000 loss: 0.0041 lr: 1e-05
iteration: 123000 loss: 0.0041 lr: 1e-05
iteration: 124000 loss: 0.0041 lr: 1e-05
iteration: 125000 loss: 0.0041 lr: 1e-05
iteration: 126000 loss: 0.0040 lr: 1e-05
iteration: 127000 loss: 0.0040 lr: 1e-05
iteration: 128000 loss: 0.0040 lr: 1e-05
iteration: 129000 loss: 0.0040 lr: 1e-05
iteration: 130000 loss: 0.0040 lr: 1e-05
iteration: 131000 loss: 0.0041 lr: 1e-05
iteration: 132000 loss: 0.0039 lr: 1e-05
iteration: 133000 loss: 0.0040 lr: 1e-05
iteration: 134000 loss: 0.0040 lr: 1e-05
iteration: 135000 loss: 0.0040 lr: 1e-05
iteration: 136000 loss: 0.0039 lr: 1e-05
iteration: 137000 loss: 0.0040 lr: 1e-05
iteration: 138000 loss: 0.0040 lr: 1e-05
iteration: 139000 loss: 0.0040 lr: 1e-05
iteration: 140000 loss: 0.0039 lr: 1e-05
iteration: 141000 loss: 0.0039 lr: 1e-05
iteration: 142000 loss: 0.0040 lr: 1e-05
iteration: 143000 loss: 0.0040 lr: 1e-05
iteration: 144000 loss: 0.0039 lr: 1e-05
iteration: 145000 loss: 0.0039 lr: 1e-05
iteration: 146000 loss: 0.0038 lr: 1e-05
iteration: 147000 loss: 0.0040 lr: 1e-05
iteration: 148000 loss: 0.0038 lr: 1e-05
iteration: 149000 loss: 0.0039 lr: 1e-05
iteration: 150000 loss: 0.0038 lr: 1e-05
iteration: 151000 loss: 0.0039 lr: 1e-05
iteration: 152000 loss: 0.0039 lr: 1e-05
iteration: 153000 loss: 0.0038 lr: 1e-05
iteration: 154000 loss: 0.0039 lr: 1e-05
iteration: 155000 loss: 0.0039 lr: 1e-05
iteration: 156000 loss: 0.0039 lr: 1e-05
iteration: 157000 loss: 0.0038 lr: 1e-05
iteration: 158000 loss: 0.0038 lr: 1e-05
iteration: 159000 loss: 0.0038 lr: 1e-05
iteration: 160000 loss: 0.0039 lr: 1e-05
iteration: 161000 loss: 0.0038 lr: 1e-05
iteration: 162000 loss: 0.0038 lr: 1e-05
iteration: 163000 loss: 0.0038 lr: 1e-05
iteration: 164000 loss: 0.0038 lr: 1e-05
iteration: 165000 loss: 0.0038 lr: 1e-05
iteration: 166000 loss: 0.0038 lr: 1e-05
iteration: 167000 loss: 0.0038 lr: 1e-05
iteration: 168000 loss: 0.0038 lr: 1e-05
iteration: 169000 loss: 0.0038 lr: 1e-05
iteration: 170000 loss: 0.0038 lr: 1e-05
iteration: 171000 loss: 0.0038 lr: 1e-05
iteration: 172000 loss: 0.0037 lr: 1e-05
iteration: 173000 loss: 0.0038 lr: 1e-05
iteration: 174000 loss: 0.0038 lr: 1e-05
iteration: 175000 loss: 0.0037 lr: 1e-05
iteration: 176000 loss: 0.0038 lr: 1e-05
iteration: 177000 loss: 0.0038 lr: 1e-05
iteration: 178000 loss: 0.0038 lr: 1e-05
iteration: 179000 loss: 0.0037 lr: 1e-05
iteration: 180000 loss: 0.0038 lr: 1e-05
iteration: 181000 loss: 0.0037 lr: 1e-05
iteration: 182000 loss: 0.0037 lr: 1e-05
iteration: 183000 loss: 0.0037 lr: 1e-05
iteration: 184000 loss: 0.0037 lr: 1e-05
iteration: 185000 loss: 0.0038 lr: 1e-05
iteration: 186000 loss: 0.0036 lr: 1e-05
iteration: 187000 loss: 0.0037 lr: 1e-05
iteration: 188000 loss: 0.0037 lr: 1e-05
iteration: 189000 loss: 0.0037 lr: 1e-05
iteration: 190000 loss: 0.0037 lr: 1e-05
iteration: 191000 loss: 0.0037 lr: 1e-05
iteration: 192000 loss: 0.0037 lr: 1e-05
iteration: 193000 loss: 0.0037 lr: 1e-05
iteration: 194000 loss: 0.0037 lr: 1e-05
iteration: 195000 loss: 0.0037 lr: 1e-05
iteration: 196000 loss: 0.0038 lr: 1e-05
iteration: 197000 loss: 0.0036 lr: 1e-05
iteration: 198000 loss: 0.0036 lr: 1e-05
iteration: 199000 loss: 0.0036 lr: 1e-05
iteration: 200000 loss: 0.0036 lr: 1e-05
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1377, in _do_call
    return fn(*args)
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1360, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1453, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
tensorflow.python.framework.errors_impl.CancelledError: Enqueue operation was cancelled
	 [[{{node fifo_queue_enqueue}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 83, in load_and_enqueue
    sess.run(enqueue_op, feed_dict=food)
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 967, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1190, in _run
    results = self._do_run(handle, final_targets, final_fetches,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1370, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/client/session.py", line 1396, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
tensorflow.python.framework.errors_impl.CancelledError: Graph execution error:

Detected at node 'fifo_queue_enqueue' defined at (most recent call last):
    File "deeplabcut/active_learning_iframes/train_all_AL_models.py", line 83, in <module>
      deeplabcut.train_network(config_path_one_model,
    File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/training.py", line 207, in train_network
      train(
    File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 168, in train
      batch, enqueue_op, placeholders = setup_preloading(batch_spec)
    File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 69, in setup_preloading
      enqueue_op = q.enqueue(placeholders_list)
Node: 'fifo_queue_enqueue'
Enqueue operation was cancelled
	 [[{{node fifo_queue_enqueue}}]]

Original stack trace for 'fifo_queue_enqueue':
  File "deeplabcut/active_learning_iframes/train_all_AL_models.py", line 83, in <module>
    deeplabcut.train_network(config_path_one_model,
  File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/training.py", line 207, in train_network
    train(
  File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 168, in train
    batch, enqueue_op, placeholders = setup_preloading(batch_spec)
  File "/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/core/train.py", line 69, in setup_preloading
    enqueue_op = q.enqueue(placeholders_list)
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/ops/data_flow_ops.py", line 346, in enqueue
    return gen_data_flow_ops.queue_enqueue_v2(
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/ops/gen_data_flow_ops.py", line 4063, in queue_enqueue_v2
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/framework/op_def_library.py", line 797, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 3754, in _create_op_internal
    ret = Operation(
  File "/home/sofia/miniconda/envs/deeplabcut-res/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 2133, in __init__
    self._traceback = tf_stack.extract_stack_for_node(self._c_op)

{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025/dlc-models/iteration-0/HorsesMay8-trainset15shuffle3/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'adam', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 8, 'dataset_type': 'imgaug', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20], [21]], 'all_joints_names': ['Nose', 'Eye', 'Nearknee', 'Nearfrontfetlock', 'Nearfrontfoot', 'Offknee', 'Offfrontfetlock', 'Offfrontfoot', 'Shoulder', 'Midshoulder', 'Elbow', 'Girth', 'Wither', 'Nearhindhock', 'Nearhindfetlock', 'Nearhindfoot', 'Hip', 'Stifle', 'Offhindhock', 'Offhindfetlock', 'Offhindfoot', 'Ischium'], 'alpha_r': 0.02, 'apply_prob': 0.5, 'contrast': {'clahe': True, 'claheratio': 0.1, 'histeq': True, 'histeqratio': 0.1, 'gamma': False, 'sigmoid': False, 'log': False, 'linear': False}, 'convolution': {'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'strength': [0.5, 1.5]}, 'embossratio': 0.1, 'sharpen': False, 'sharpenratio': 0.3}, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Horses_Byron15shuffle3.mat', 'decay_steps': 30000, 'display_iters': 1000, 'init_weights': '/home/sofia/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_HorsesMay8/Documentation_data-Horses_15shuffle3.pickle', 'min_input_size': 64, 'multi_stage': False, 'multi_step': [[0.0001, 7500], ['5e-05', 12000], ['1e-05', 200000]], 'net_type': 'resnet_50', 'num_joints': 22, 'pos_dist_thresh': 17, 'project_path': '/home/sofia/datasets/Horse10_AL_uncert_kmeans_OH/Horse10_AL_uncert_kmeans025', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}, 'snow': False, 'clouds': False, 'fog': False, 'snow_flakes': False, 'rain': False}
Starting training....
The network is now trained and ready to evaluate. Use the function 'evaluate_network' to evaluate the network.
